{"version":3,"file":"Redux-8a1c930b.js","sources":["../../src/notes/client-state/Redux.mdx"],"sourcesContent":["import { Source, Meta } from \"@storybook/blocks\";\n\n<Meta name=\"Notes/Client State/Redux\" title=\"Notes/Client State/Redux\" />\n\n# Redux\n\nNov 5, 2023\n\n<hr />\n\n- [Redux](https://redux.js.org/introduction/getting-started)\n- [Redux Core Concepts](https://redux.js.org/tutorials/fundamentals/part-2-concepts-data-flow)\n- [Redux Toolkit](https://redux-toolkit.js.org/introduction/getting-started)\n\n## Table of contents\n\n- [Overview](#overview)\n- [One-Way Data Flow](#one-way-data-flow)\n- [Actions](#actions)\n- [Reducers](#reducers)\n- [Selectors](#selectors)\n  - [Optimizing Selectors with Memoization](#optimizing-selectors-with-memoization)\n- [Slice](#slice)\n- [Middleware](#middleware)\n  - [Redux Thunk Middleware](#redux-thunk-middleware)\n  - [Async Thunk](#async-thunk)\n- [Store Normalization](#store-normalization)\n- [RTK Query](#rtk-query)\n\n## Overview\n\nRedux is a library for managing client application state using a global store with a variation of a pub/ sub pattern.\n\nThe store is intended to be a single source of truth: a singular place where any bit of data exists only once, as well as the only place\nwhere state can be updated or read from.\n\nView components are only allowed to dispatch events \\(what occurred in the UI\\) and are not permitted to update state directly.\n\nRedux is most useful in cases where:\n\n- You have large amounts of application state that are needed in many places in the app.\n- The app state is updated frequently.\n- The logic to update that state may be complex.\n- The app has a medium or large-sized codebase, and might be worked on by many people.\n- You need to see how that state is being updated over time.\n\n## One-Way Data Flow\n\nOne-way data flow is a fundamental concept of redux in which data always flows in a unidirectional cycle like so:\n\n<p align=\"center\">\n  <a href=\"https://github.com/JonnyPickard/JonnyPickard.github.io\">\n    <img\n      src=\"./src/assets/diagrams/ReduxDataFlowDiagram.gif\"\n      alt=\"Redux Data Flow\"\n      width=\"320px\"\n    />\n  </a>\n</p>\n\nUsing the above diagram:\n\n1. The view component \\(UI\\) subscribes to the store enabling it to:\n\n- Request the data it requires \\(bank balance: $0\\).\n  - When the bank balance changes the view component recieves the new balance then rerenders.\n- Dispatch events back to the store.\n\n2. The user deposits $10 using the UI:\n\n- Ah action is constructed \\(An object containing event data\\).\n\n```ts\nconst depositAction = {\n  type: \"bank/deposit\",\n  payload: 10,\n};\n```\n\n3. The action is then dispatched back to the store which decides how to update it's state.\n\n- `Current bank balance: $0` + `$10` = `New bank balance: $10`\n\n4. The UI will recieve the updated bank balance of `$10` and rerender accordingly.\n\n## Actions\n\nAn `Action` is a javascript object that has a type field.\n\n- Action object can have other fields containing additional information about what happened.\n- The additional data by convention is put in a field called `payload`.\n\n```js\nconst addTodoAction = {\n  type: \"todos/todoAdded\",\n  payload: \"Buy milk\",\n};\n```\n\n## Reducers\n\nA `Reducer` is a function that receives the current `state` and an `action` object, then decides\nhow to update state if necessary.\n\n- The store registers the reducer functions on initialisation/ configuration.\n\n```js\nconst store = configureStore({ reducer: counterReducer });\n```\n\n- They must only calculate the `new state` value based on the `current state` + `action`\n- They are not allow to modify existing state. They must make `immutable updates` by copying the existing state.\n- They must not do any `async logic` or cause `side effects`.\n\n## Selectors\n\nA function used to extract specific pieces of data from the store.\n\nThey are:\n\n- Reusable: a single way to access same piece of derived data across different locations in the view.\n- Maintainable: they decouple components from the store structure allowing for easier testing.\n\nBasic example:\n\n```ts\nimport React from \"react\";\nimport { useSelector } from \"react-redux\";\n\nexport const TodoListItem = (props) => {\n  const todo = useSelector((state) => state.todos[props.id]);\n  return <div>{todo.text}</div>;\n};\n```\n\nHowever, it makes more sense to define selectors as reusable functions in case:\n\n- Multiple components need to access the same piece of state.\n- If you change the store structure, you then only need to modify the selector.\n\nBecause of this, it's often a good idea to define reusable selectors directly inside slice files, rather than always defining them inside of a component.\n\n<br />\n\n### Optimizing Selectors with Memoization\n\n[Optimizing Selectors with Memoization](https://redux.js.org/usage/deriving-data-selectors#optimizing-selectors-with-memoization)\n\n#### Context\n\n1. Selectors used with `useSelector` or `mapState` will be re-run after every dispatched action.\n2. `useSelector` and `mapState` use the `===` reference equality check on the selectors return values to determine if the component\n   needs to rerender.\n\n```ts\n// Example 1. Forever rerendering.\nfunction TodoList() {\n  const completedTodos = useSelector((state) =>\n    state.todos.map((todo) => todo.completed)\n  );\n}\n```\n\n> Example 1. As the map function always returns a new array the reference equality check `===` will fail & the component will therefor rerender on each dispatched action!\n\n```ts\n// Example 2. Expensive filtering.\nfunction ExampleComplexComponent() {\n  const data = useSelector((state) => {\n    const initialData = state.data;\n    const filteredData = expensiveFiltering(initialData);\n\n    return filteredData;\n  });\n}\n```\n\n> Example 2. This expensive logic will be rerun after every dispatched action when, theoretically, it would ever need to rerun if state.data changes.\n\n#### Solution\n\nWe can use a form of caching called `Memoization` to decide whether the function needs to be rerun.\n`Memoization` works by storing the inputs and results of a function when it is first called.\nIf the function inputs are the same on subsequent calls it will skip the function call and return the cached return value.\nIf the function inputs change it will rerun the function and store the new inputs and return values to enable memoizing subsequent calls\n\nThe most common pattern for memoizing selectors is using a library called [Reselect](https://github.com/reduxjs/reselect).\n\nReselect exports a [createSelector](https://github.com/reduxjs/reselect#createselectorinputselectors--inputselectors-resultfunc-selectoroptions) API, which generates memoized selector functions.\n\nIf the selector created with `createSelector` is called again with the same arguments, the previously cached result is returned instead of recalculating a new result.\n\n```ts\n// Create selector accepts one or more `input` selectors.\n// and an output selector which recieves the results of the input selectors and returns a derived value.\n// An output selector should always contain some transformation logic!\nconst selectUsersOver30 = createSelector(\n  // Input selector\n  (state) => state.usersList,\n  // Output selector\n  (usersList) => usersList.filter((user) => user.age > 30)\n);\n```\n\n## Slice\n\nA function that accepts an initial state, an object of reducer functions, and a \"slice name\",\nand `automatically generates action creators and action types` that correspond to the reducers and state.\n\n```typescript\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport type { PayloadAction } from \"@reduxjs/toolkit\";\n\ninterface CounterState {\n  value: number;\n}\n\nconst initialState = { value: 0 } as CounterState;\n\nconst counterSlice = createSlice({\n  name: \"counter\",\n  initialState,\n  reducers: {\n    increment(state) {\n      state.value++;\n    },\n    decrement(state) {\n      state.value--;\n    },\n    incrementByAmount(state, action: PayloadAction<number>) {\n      state.value += action.payload;\n    },\n  },\n});\n\nexport const { increment, decrement, incrementByAmount } = counterSlice.actions;\nexport default counterSlice.reducer;\n```\n\n## [Middleware](https://redux.js.org/understanding/thinking-in-redux/glossary#middleware)\n\nRedux Middleware is higher order function that composes a dispatch function to return a new dispatch function.\n\n```ts\ntype Middleware = ({ dispatch: Dispatch; getState: () => State }) => (next: Dispatch) => Dispatch;\n```\n\n<p align=\"center\">\n  <a href=\"https://github.com/JonnyPickard/JonnyPickard.github.io\">\n    <img\n      src=\"./src/assets/diagrams/ReduxAsyncDataFlowDiagram.gif\"\n      alt=\"Redux Data Flow Async\"\n      width=\"320px\"\n    />\n  </a>\n</p>\n\n> Example middleware that makes an api request.\n\nIt's mainly used for writing logic that has side effects such as logging, routing and asynchronous api calls.\n\nMiddleware is composable using [function composition](https://redux.js.org/api/compose): a technique in which you combine two or more functions to produce a new function.\nThe idea is to take the output of one function and use it as the input for another.\n\n```ts\n// 1. slice(bread)\n// 2. toast(slicedBread)\n// 3. spreadButter(slicedToast)\n// 4. addJam(butteredToast)\n\nconst makeSandwich = (bread) => addJam(spreadButter(toast(sliceBread(bread))));\n\nmakeSandwich(\"Sourdough Loaf\");\n```\n\n### [Redux Thunk Middleware](https://redux.js.org/usage/writing-logic-thunks)\n\nThe word \"thunk\" is a programming term that means \"a piece of code that does some delayed work\".\n\nRedux Thunk is middleware for redux that allows you to dispatch functions instead of actions.\n\nA thunk function may contain any arbitrary logic, sync or async, and can call dispatch or getState at any time.\n\n```ts\nconst thunkFunction = (dispatch, getState) => {\n  // logic here that can dispatch actions or read state\n};\n\nstore.dispatch(thunkFunction);\n```\n\nFor consistency with dispatching normal action objects, we typically write these as thunk action creators, which return the thunk function.\nThese action creators can take arguments that can be used inside the thunk.\n\n```ts\nconst depositFunds = (amount) => {\n  return (dispatch, getState) => {\n    const balanceBefore = getState().balance;\n    dispatch(incrementByAmount(amount));\n    const balanceAfter = getState().balance;\n  };\n};\n\nstore.dispatch(depositFunds(10));\n```\n\n### Async Thunk\n\n[Using Async Thunk](https://redux.js.org/usage/writing-logic-thunks#using-createasyncthunk)\n\nBecause writing async logic with thunks can be tedious \\(you have to write logic to handle pending/ fulfilled/ rejected states\\)\nRedux toolkit has a special thunk api for handling async logic: `createAsyncThunk`.\n\n`createAsyncThunk` is a function that accepts a Redux action type string and a callback function that should return a promise.\n\nThe Async Thunk api will then automatically generate & dispatch actions based on the promise status returned by the callback function.\n\n```ts\n// todosSlice.js\n\nexport const saveNewTodo = createAsyncThunk(\n  \"todos/saveNewTodo\",\n  async (text) => {\n    const initialTodo = { text };\n    const response = await client.post(\"/fakeApi/todos\", { todo: initialTodo });\n    return response.todo;\n  }\n);\n\nconst todosSlice = createSlice({\n  name: \"todos\",\n  initialState,\n  reducers: {\n    // omit reducer cases\n  },\n  // The extraReducers allows you to respond to an action in your slice reducer but does not create an action creator function.\n  extraReducers: (builder) => {\n    builder\n      .addCase(saveNewTodo.pending, (state, action) => {\n        state.status = \"saving\";\n      })\n      .addCase(saveNewTodo.fulfilled, (state, action) => {\n        state.todos = [...state.todos, action.payload.newTodo];\n        state.status = \"save successful\";\n      });\n  },\n});\n```\n\n```ts\n// NewTodoForm.js\n\nconst handleSubmit = async () => {\n  await dispatch(saveNewTodo(todoText));\n};\n```\n\n`saveNewTodo.pending` & `saveNewTodo.fulfilled` actions are automatically dispatched and are therefor able to be caught by the\ntodosSlice reducers.\n\n## [Store Normalization](https://redux.js.org/usage/structuring-reducers/normalizing-state-shape#designing-a-normalized-state)\n\nWhen dealing with data that is relational or nested the resulting structure can end up rather complex & repeated in places.\n\nThis presents various issues:\n\n- When there is duplicate data across the store it becomes harder to make sure it's updated appropriately.\n- Nested data means the corresponding reducer logic has to be more nested/ complicated and quickly becomes significantly more complicated to maintain.\n- Since immutable data updates require all ancestors in the state tree to be copied and updated as well,\n  and new object references will cause connected UI components to re-render, an update to a deeply nested data object could force totally unrelated UI components to re-render even if the data they're displaying hasn't actually changed.\n\n```ts\n// 1. Unnormalized state\n\nconst blogPosts = [\n  {\n    id: \"post1\",\n    author: { username: \"user1\", name: \"User 1\" },\n    body: \"......\",\n    comments: [\n      {\n        id: \"comment1\",\n        author: { username: \"user2\", name: \"User 2\" },\n        comment: \".....\",\n      },\n      {\n        id: \"comment2\",\n        author: { username: \"user3\", name: \"User 3\" },\n        comment: \".....\",\n      },\n    ],\n  },\n];\n```\n\nThe basic concepts of normalizing data are:\n\n- Each type of data gets its own \"table\" in the state.\n- Each \"data table\" should store the individual items in an object, with the IDs of the items as keys and the items themselves as the values.\n- Any references to individual items should be done by storing the item's ID.\n- Arrays of IDs should be used to indicate ordering.\n\nHere is an example of how you could normalize the `blogPosts` state shape:\n\n```ts\n// 2. After Normalization\n\n{\n  posts: {\n    byId: {\n      post1: {\n        id: \"post1\",\n        author: \"user1\",\n        body: \"......\",\n        comments: [\"comment1\", \"comment2\"],\n      },\n    },\n    allIds: [\"post1\"],\n  },\n  comments: {\n    byId: {\n      comment1: {\n        id: \"comment1\",\n        author: \"user2\",\n        comment: \".....\",\n      },\n      comment2: {\n        id: \"comment2\",\n        author: \"user3\",\n        comment: \".....\",\n      },\n    },\n    allIds: [\"comment1\", \"comment2\"],\n  },\n  users: {\n    byId: {\n      user1: {\n        username: \"user1\",\n        name: \"User 1\",\n      },\n      user2: {\n        username: \"user2\",\n        name: \"User 2\",\n      },\n      user3: {\n        username: \"user3\",\n        name: \"User 3\",\n      },\n    },\n    allIds: [\"user1\", \"user2\", \"user3\"],\n  },\n};\n```\n\n## [RTK Query](https://redux-toolkit.js.org/rtk-query/overview)\n\n> 🚧 I think it's worth covering this in a separate post as theres a lot of in depth knowledge/ features.\n"],"names":["_createMdxContent","props","_components","_provideComponents","_jsxs","_Fragment","_jsx","Meta","MDXContent","MDXLayout"],"mappings":"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"}